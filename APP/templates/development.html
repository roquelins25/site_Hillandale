<!DOCTYPE html>
<html lang="en" class="light">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>BI Portal - Global Eggs</title>

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>

    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        primary: "#f27f0d",
                        "background-light": "#f7f8f5",
                        "background-dark": "#f27f0d",
                        "brand-dark": "#ffd4a9",
                        "brand-gray": "#2b2e25",
                    },
                    fontFamily: {
                        display: ["Inter", "sans-serif"],
                    },
                },
            },
        };
    </script>

    <style type="text/tailwindcss">
        .material-symbols-outlined {
            font-size: 20px;
        }

        .active-nav {
            border-left: 4px solid #f27f0d;
            background-color: rgba(160, 249, 6, 0.1);
        }

        .accordion-content {
            transition: max-height 0.25s ease, opacity 0.25s ease;
        }

        .sidebar-scroll::-webkit-scrollbar { width: 4px; }
        .sidebar-scroll::-webkit-scrollbar-thumb {
            background: #2b2e25;
            border-radius: 10px;
        }

        /* Sidebar deslizante no mobile */
        #sidebar {
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        #sidebar-overlay {
            transition: opacity 0.3s ease;
        }

        /* Rotação da seta do accordion */
        .accordion-toggle .arrow {
            transition: transform 0.25s ease;
        }
        .accordion-toggle.open .arrow {
            transform: rotate(180deg);
        }
    </style>
</head>

<!--
    MOBILE  : overflow-x-hidden permite scroll vertical
    DESKTOP : overflow-hidden mantém o layout fixo em tela cheia
-->
<body class="font-display bg-background-light dark:bg-background-dark
             text-slate-900 dark:text-slate-100
             overflow-x-hidden lg:overflow-hidden">

<div class="flex h-screen w-full relative">

    <!-- ── OVERLAY (mobile) ─────────────────────────────── -->
    <div
        id="sidebar-overlay"
        class="fixed inset-0 bg-black/60 z-20 opacity-0 pointer-events-none lg:hidden"
        onclick="closeSidebar()"
    ></div>

    <!-- ── SIDEBAR ───────────────────────────────────────── -->
    <!--
        MOBILE  : fixed, começa fora da tela (-translate-x-full)
                  desliza para dentro quando aberto (translate-x-0)
        DESKTOP : lg:relative lg:translate-x-0 — sempre visível
    -->
    <aside
        id="sidebar"
        class="fixed top-0 left-0 z-30 h-full w-72 -translate-x-full
               lg:relative lg:w-64 lg:translate-x-0
               bg-brand-dark flex flex-col border-r border-black/5"
    >
        <!-- Logo + botão fechar -->
        <div class="p-5 flex items-center gap-3 border-b border-black/5">
            <div class="w-9 h-9 rounded-lg bg-slate-100 flex items-center justify-center shrink-0">
                <img
                    src="https://hevogroup.es/wp-content/uploads/2025/04/Global-Eggs_-logo.png"
                    alt="Global Eggs"
                    class="w-full h-full object-contain p-1"
                />
            </div>
            <div class="flex-1 min-w-0">
                <p class="text-Black font-bold leading-none truncate">Global Eggs</p>
                <p class="text-Black/40 text-xs uppercase tracking-widest mt-0.5">BI Portal</p>
            </div>
            <!-- Botão fechar — só no mobile -->
            <button
                onclick="closeSidebar()"
                class="lg:hidden ml-auto p-1 rounded-lg text-Black/50 hover:text-Black hover:bg-Black/10 transition-colors"
                aria-label="Fechar menu"
            >
                <span class="material-symbols-outlined">close</span>
            </button>
        </div>

        <!-- NAV -->
        <nav class="flex-1 px-3 py-4 space-y-1 sidebar-scroll overflow-y-auto">

            <!-- USA -->
            <div>
                <button class="accordion-toggle w-full flex items-center justify-between px-3 py-2 text-xs font-bold uppercase text-black/50">
                    <span  class= "material-symbols-outlined text-[20px] text-primary">flag</span>
                    <span>Hillandale</span>
                    <span class="material-symbols-outlined transition-transform">expand_more</span>
                </button>

                <div class="accordion-content hidden mt-1 space-y-1">

                    <a href="#" class="nav-btn flex items-center gap-3 px-3 py-2 text-black/70 hover:bg-black/5"
                       data-src="https://app.powerbi.com/view?r=eyJrIjoiZTBkZTU4ZTMtOTc3My00NmE1LTllM2QtNGJjZjE5YWUwZDU1IiwidCI6ImE4YTc5ZmJlLTQ1MzktNGRhYi1iYjAzLTdhMGZiNDJhNGMzZSIsImMiOjN9">
                        <span class="material-symbols-outlined">analytics</span>
                        <span class="text-sm font-semibold">Commercial</span>
                    </a>

                    <a href="#" class="nav-btn flex items-center gap-3 px-3 py-2 text-black/70 hover:bg-black/5"
                       data-src="https://app.powerbi.com/view?r=eyJrIjoiMzhhZTJmYTItMWU0MS00NWY1LTg0NzUtNDAxMGQ3ZmQzNTkwIiwidCI6ImE4YTc5ZmJlLTQ1MzktNGRhYi1iYjAzLTdhMGZiNDJhNGMzZSIsImMiOjN9">
                        <span class="material-symbols-outlined">stacked_bar_chart</span>
                        <span class="text-sm">Production</span>
                    </a>


                    <a href="#" class="nav-btn flex items-center gap-3 px-3 py-2 text-black/70 hover:bg-black/5"
                       data-src="https://app.powerbi.com/view?r=eyJrIjoiZGQ3YzY5YzgtMWZhMC00YzFjLWEwNTUtMGYxOTQ5OWI0NTJhIiwidCI6ImE4YTc5ZmJlLTQ1MzktNGRhYi1iYjAzLTdhMGZiNDJhNGMzZSIsImMiOjN9">
                        <span class="material-symbols-outlined">stacked_bar_chart</span>
                        <span class="text-sm">PO Approvals</span>
                    </a>

                </div>
            </div>

            <!-- BRAZIL -->
            <div>
                <button class="accordion-toggle w-full flex items-center justify-between px-3 py-2 text-xs font-bold uppercase text-black/50">
                    <span id ="Flag" class= "material-symbols-outlined text-[20px] text-primary">flag</span>
                    <span>Brazil</span>
                    <span class="material-symbols-outlined transition-transform">expand_more</span>
                </button>

                <div class="accordion-content hidden mt-1 space-y-1">

                    <a
                        href="https://granjafaria.insolo.com.br/"
                        target="_blank"
                        rel="noopener noreferrer"
                        class="flex items-center gap-3 px-3 py-2 text-black/70 hover:text-black hover:bg-black/5 rounded-lg"
                    >
                        <span class="material-symbols-outlined">analytics</span>
                        <span class="text-sm">Portal</span>
                        <span class="material-symbols-outlined text-xs opacity-60">open_in_new</span>
                    </a>

                </div>
            </div>

            <!-- Espanha -->
            <div>
                <button class="accordion-toggle w-full flex items-center justify-between px-3 py-2 text-xs font-bold uppercase text-black/50">
                    <span id ="Flag" class= "material-symbols-outlined text-[20px] text-primary">flag</span>
                    <span>Hevo</span>
                    <span class="material-symbols-outlined transition-transform">expand_more</span>
                </button>

                <div class="accordion-content hidden mt-1 space-y-1">

                    <a href="#" class="nav-btn flex items-center gap-3 px-3 py-2 text-black/70 hover:bg-black/5"
                       data-src="https://app.powerbi.com/view?r=eyJrIjoiY2Q3ZmU3ZTQtNjJjNi00Zjg1LThhZjktZTgzYzI1Yjg0YzZlIiwidCI6ImE4YTc5ZmJlLTQ1MzktNGRhYi1iYjAzLTdhMGZiNDJhNGMzZSIsImMiOjN9&pageName=fce20b753b1e7dc99072">
                        <span class="material-symbols-outlined">analytics</span>
                        <span class="text-sm font-semibold">Commercial</span>
                    </a>
                </div>
            </div>

            
        </nav>

        <!-- Development Area -->
        <div class="p-4 border-t border-black/5">
            <a
                class="flex items-center gap-3 px-3 py-2.5 rounded-lg
                       text-primary hover:bg-primary/10 transition-colors"
                href="{{ url_for('main.logout') }}"
                rel="noopener noreferrer"
            >
                <span class="material-symbols-outlined text-[18px]">terminal</span>
                <span class="text-sm font-bold tracking-tight">Production Area</span>
            </a>
        </div>
    </aside>

    <!-- ── MAIN ──────────────────────────────────────────── -->
    <main class="flex-1 min-w-0 flex flex-col overflow-hidden">

        <!-- HEADER -->
        <!--
            MOBILE/TABLET : mostra hamburguer + logo
            DESKTOP       : header limpo (lg:), sidebar já está visível
        -->
        <header class="h-16 shrink-0 bg-what dark:bg-brand-dark/50
                        border-b border-slate-200 dark:border-black/5
                        flex items-center px-4 gap-3">

            <!-- Hamburguer — oculto no desktop -->
            <button
                onclick="openSidebar()"
                class="lg:hidden flex items-center justify-center w-9 h-9 rounded-lg
                       text-slate-500 dark:text-black/60
                       hover:bg-slate-100 dark:hover:bg-black/10 transition-colors shrink-0"
                aria-label="Abrir menu"
            >
                <span class="material-symbols-outlined">menu</span>
            </button>

            <!-- Logo mobile/tablet -->
            <div class="flex items-center gap-2 lg:hidden">
                <img
                    src="https://hevogroup.es/wp-content/uploads/2025/04/Global-Eggs_-logo.png"
                    alt="Global Eggs"
                    class="w-7 h-7 object-contain"
                />
                <span class="text-sm font-bold text-slate-800 dark:text-black leading-none">
                    Global Eggs
                    <span class="hidden sm:inline text-slate-400 dark:text-black/40 font-normal"> — BI Portal</span>
                </span>
            </div>

            <div class="ml-auto"></div>
        </header>

        <!-- CONTENT -->
        <!--
            MOBILE  : p-2 (máximo aproveitamento de tela)
            TABLET  : sm:p-4
            DESKTOP : lg:p-6
        -->
        <div class="flex-1 p-2 sm:p-4 lg:p-6 overflow-hidden">
            <div class="h-full rounded-lg border border-slate-200 dark:border-black/5
                        bg-black dark:bg-brand-dark/50 overflow-hidden">
                <iframe
                    id="dashboardFrame"
                    src="https://app.powerbi.com/view?r=eyJrIjoiZTBkZTU4ZTMtOTc3My00NmE1LTllM2QtNGJjZjE5YWUwZDU1IiwidCI6ImE4YTc5ZmJlLTQ1MzktNGRhYi1iYjAzLTdhMGZiNDJhNGMzZSIsImMiOjN9"
                    class="w-full h-full min-h-[420px]"
                    frameborder="0"
                    allowfullscreen
                ></iframe>
            </div>
        </div>

        <!-- FOOTER -->
        <footer class="shrink-0 px-4 py-3 text-xs text-slate-400
                        border-t border-slate-200 dark:border-black/5">
            © 2026 Global Eggs — BI Portal
        </footer>

    </main>
</div>

<script>
    // ── Sidebar mobile ──────────────────────────────────
    function openSidebar() {
        const sidebar = document.getElementById("sidebar");
        const overlay = document.getElementById("sidebar-overlay");
        sidebar.classList.replace("-translate-x-full", "translate-x-0");
        overlay.classList.replace("opacity-0", "opacity-100");
        overlay.classList.remove("pointer-events-none");
        document.body.style.overflow = "hidden";
    }

    function closeSidebar() {
        const sidebar = document.getElementById("sidebar");
        const overlay = document.getElementById("sidebar-overlay");
        sidebar.classList.replace("translate-x-0", "-translate-x-full");
        overlay.classList.replace("opacity-100", "opacity-0");
        overlay.classList.add("pointer-events-none");
        document.body.style.overflow = "";
    }

    document.addEventListener("keydown", e => {
        if (e.key === "Escape") closeSidebar();
    });

    window.addEventListener("resize", () => {
        if (window.innerWidth >= 1024) closeSidebar();
    });

    // ── Accordion ───────────────────────────────────────
    document.querySelectorAll(".accordion-toggle").forEach(toggle => {
        toggle.addEventListener("click", () => {
            const content = toggle.nextElementSibling;
            content.classList.toggle("hidden");
            toggle.classList.toggle("open");
        });
    });

    // ── Troca de iframe ──────────────────────────────────
    const iframe  = document.getElementById("dashboardFrame");
    const buttons = document.querySelectorAll(".nav-btn");

    buttons.forEach(btn => {
        btn.addEventListener("click", e => {
            e.preventDefault();
            if (btn.classList.contains("dev-disabled")) return;

            iframe.src = btn.dataset.src;

            buttons.forEach(b => b.classList.remove("active-nav", "text-primary"));
            btn.classList.add("active-nav", "text-primary");

            // Fecha sidebar no mobile após selecionar
            if (window.innerWidth < 1024) closeSidebar();
        });
    });
</script>

</body>
</html>